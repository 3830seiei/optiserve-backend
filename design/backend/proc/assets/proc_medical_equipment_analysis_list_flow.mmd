graph TD
    A[分析設定一覧取得リクエスト] --> B[医療機関ID決定]
    B --> C[権限チェック]
    C --> D[ベースクエリ構築]
    D --> E[分類IDフィルタ適用]
    E --> F[総件数取得]
    F --> G[データ取得（ページング）]
    G --> H[有効値計算]
    H --> I[分類情報取得]
    I --> J[履歴パース]
    J --> K[レスポンス構築]
    K --> L[設定一覧返却]
    
    B -->|medical_id省略時| M[認証ユーザーの医療機関取得]
    C -->|権限なし| N[403 Forbidden]
    H -->|上書き設定存在| O[上書き値を有効値とする]
    H -->|上書き設定なし| P[デフォルト値を有効値とする]