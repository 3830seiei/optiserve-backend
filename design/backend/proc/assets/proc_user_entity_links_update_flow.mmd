graph TD
    A[更新リクエスト受信] --> B[基本権限チェック]
    B --> C{システム管理者？}
    C -->|Yes| D[全フィールド更新許可]
    C -->|No| E[医療機関ユーザー権限チェック]
    E --> F[制限フィールド検出]
    F --> G{制限フィールド変更？}
    G -->|Yes| H[403 Forbidden]
    G -->|No| I[許可フィールドのみ更新]
    D --> J[更新処理実行]
    I --> J