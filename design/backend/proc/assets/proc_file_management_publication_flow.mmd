graph TD
    A[オンプレミス：レポート生成] --> B[システム：レポート公開API呼び出し]
    B --> C[システムAPIキー認証]
    C --> D[医療機関存在チェック]
    D --> E[公開年月フォーマットチェック]
    E --> F[オンプレミスレポートファイル取得]
    F --> G[公開ディレクトリにコピー]
    G --> H[DB履歴記録（report_publication_log）]
    H --> I[通知メール送信]
    I --> J[公開完了レスポンス]
    
    C -->|認証エラー| K[401 Unauthorized]
    D -->|医療機関なし| L[404 Not Found]
    F -->|レポートなし| M[404 Not Found]